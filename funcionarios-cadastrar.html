<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="./css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">

    <title>Funcionários</title>
</head>
<body>
    <!-- Cabeçalho -->
    <header class="px-4 d-flex align-items-center">
        <div class="flex-grow-1">
            <img src="./img/ifood-logo.svg" alt="Logo do iFood" class="logo-ifood ms-5">
        </div>
        
        <div class="d-flex gap-4">
            <img src="./img/bell.svg" alt="Ícone de Notificação" class="pointer">
            <img src="./img/mensagem.svg" alt="Ícone de Mensagem" class="pointer">
            <a href="perfil.html">
                <img src="/img/perfil.svg" alt="Ícone de Perfil" class="pointer">
            </a>
        </div>
    </header>
    
    <div class="d-flex">
        <!-- Navegação -->
        <div class="w-25 d-flex navegacao flex-column">
            <div class="w-100 d-flex justify-content-center align-items-center" style="height: 200px;">
                <img src="./img/brabo-logo.png" alt="Logo da Brabo" class="rounded-circle h-50">
            </div>

            <nav class="d-flex justify-content-center align-items-center">
                <ul class="nav nav-pills d-flex flex-column gap-3">
                    <li class="nav-item dropdown d-flex">
                        <img src="./img/dashboard.svg" alt="Ícone de Casa" class="mx-3">
                        <a class="link-nav dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" href="#">Dashboard</a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="dashboard-entrada.html">Entradas</a></li>
                            <li><a class="dropdown-item" href="dashboard-saidas.html">Saídas</a></li>
                        </ul>
                    </li>
                    <li class="nav-item d-flex">
                        <img src="./img/produtos.svg" alt="Ícone de Casa" class="mx-3">
                        <a class="link-nav dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" href="#">Produtos</a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="produtos-cadastrar.html">Cadastrar</a></li>
                            <li><a class="dropdown-item" href="produtos-lista.html">Lista</a></li>
                        </ul>
                    </li>
                    <li class="nav-item d-flex">
                        <img src="./img/fornecedores.svg" alt="Ícone de Casa" class="mx-3">
                        <a class="link-nav dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" href="#">Fornecedores</a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="fornecedores-cadastrar.html">Cadastrar</a></li>
                            <li><a class="dropdown-item" href="fornecedores-lista.html">Lista</a></li>
                        </ul>
                    </li>
                    <li class="nav-item d-flex">
                        <img src="./img/funcionarios.svg" alt="Ícone de Casa" class="mx-3">
                        <a class="link-nav-active dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" href="#">Funcionários</a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="funcionarios-cadastrar.html">Cadastrar</a></li>
                            <li><a class="dropdown-item" href="funcionarios-lista.html">Lista</a></li>
                        </ul>
                    </li>
                    <li class="nav-item d-flex">
                        <img src="./img/pagamentos.svg" alt="Ícone de Casa" class="mx-3">
                        <a class="link-nav dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" href="#">Pagamentos</a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="pagamentos-cadastrar.html">Cadastrar</a></li>
                            <li><a class="dropdown-item" href="pagamentos-lista.html">Lista</a></li>
                        </ul>
                    </li>
                    <li class="nav-item d-flex">
                        <img src="./img/vendas.svg" alt="Ícone de Casa" class="mx-3">
                        <a class="link-nav dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" href="#">Vendas</a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="vendas-cadastrar.html">Cadastrar</a></li>
                            <li><a class="dropdown-item" href="vendas-lista.html">Lista</a></li>
                        </ul>
                    </li>
                </ul>
            </nav>
        </div>

        <!-- Form -->
        <div class="w-100 container p-3">
            <h2 id="cadastrar-id" class="mt-3 ms-2">Cadastrar Funcionários: 1</h2>

            <form class="d-flex mt-4 w-100">
                <!-- Primeira Coluna -->
                <div class="d-flex flex-column w-50 p-2">
                    <label for="nome" class="ms-1">Nome:</label>
                    <input id="nome" name="nome" type="text" class="rounded-3 w-100" />

                    <label for="email" class="ms-1 mt-4">Email:</label>
                    <input id="email" name="email" type="text" class="rounded-3 w-100" />

                    <label for="conta" class="ms-1 mt-4">Conta Corrente:</label>
                    <input id="conta" name="conta" type="text" class="rounded-3 w-100" />

                    <label for="cargo" class="ms-1 mt-4">Cargo:</label>
                    <input id="cargo" name="cargo" type="text" class="rounded-3 w-100" />
                </div>

                <!-- Segunda Coluna -->
                <div class="d-flex flex-column w-50 p-2">
                    <label for="cpf" class="ms-1">CPF:</label>
                    <input id="cpf" name="cpf" type="text" onkeydown="mascararCpf(event)" class="rounded-3 w-75" maxlength="11" />

                    <label for="telefone" class="ms-1 mt-4">Telefone:</label>
                    <input id="telefone" name="telefone" type="text" onkeydown="mascararTelefone(event)" class="rounded-3 w-75" />

                    <label for="pix" class="ms-1 mt-4">Chave Pix:</label>
                    <input id="pix" name="pix" type="text" class="rounded-3 w-75" />

                    <label for="senha" class="ms-1 mt-4">Senha:</label>
                    <input id="senha" name="senha" type="password" class="rounded-3 w-75" />

                    <input id="cadastrar" type="submit" class="rounded-3 mt-4" value="Cadastrar" />
                </div>
            </form>
        </div>
    </div>

    <script type="text/javascript">
    let id;

    window.addEventListener("load", function () {
        let idJSON = JSON.parse(localStorage.getItem('funcionarios'));
        id = idJSON ? Object.keys(idJSON).length + 1 : 1;

        document.getElementById('cadastrar-id').innerText = "Cadastrar Funcionários: " + id;
    });

    let cpf = '';
    function mascararCpf(event) {
        event.preventDefault();

        if(event.key == 'Backspace' && cpf != '') {
            cpf = cpf.slice(0, -1); 
        }
        else if(event.key.match(/[0-9]/g) && cpf.length < 11) {
            cpf += event.key; 
        }

        if (cpf != '') {
            let pontos = cpf.length > 2?Math.floor((cpf.length - 3) / 3):0;

            let mask = cpf;
            if(cpf.length > 2) {
                mask = cpf.split("");
                mask = mask.reverse();
                mask = mask.join("");

                mask = mask.substring(0, 2) + '-' + mask.substring(2, mask.length);

                mask = mask.split("");
                mask = mask.reverse();
                mask = mask.join("");
            }

            mask = mask.replace('.','');

            for(var i = 0; i < pontos; i++) {
                var resto = (mask.length - 3 - i) % 3;
                resto = resto == 0 ? 3 : resto;

                mask = mask.substring(0, resto + (3 * i) + i) + '.' + mask.substring(resto + (3 * i) + i, mask.length);
            }

            event.target.value = mask;
        }
        else {
            event.target.value = cpf;
        }
    }

    let tel = '';
    function mascararTelefone(event) {
        event.preventDefault();

        if(event.key == 'Backspace' && tel != '') {
            tel = tel.slice(0, -1); 
        }
        else if(event.key.match(/[0-9]/g) && tel.length < 11) {
            tel += event.key;
        }

        if (tel != '') {

            let mask = tel;
            if(tel.length > 2) {
                mask = '(' + mask.substring(0, 2) + ') ' + mask.substring(2, mask.length);
            }

            if(tel.length > 6) {
                mask = mask.substring(0, 9) + '-' + mask.substring(9, mask.length);
            }

            if(tel.length > 10) {
                mask = mask.replace('-','');
                mask = mask.substring(0, 10) + '-' + mask.substring(10, mask.length);
            }

            event.target.value = mask;
        }
        else {
            event.target.value = tel;
        }
    }

    function handleSubmit(event) {
        event.preventDefault();

        const data = new FormData(event.target);

        var date = new Date();
        var dataAtual = date.getDate().toString().padStart(2, '0') + '/' + (date.getMonth() + 1).toString().padStart(2, '0') + '/' + date.getFullYear();

        let value = Object.fromEntries(data.entries());
        let lista = JSON.parse(localStorage.getItem('funcionarios'));
        let newEntry = {};
        newEntry[id] = { nome: value.nome, email: value.email, conta: value.conta, cargo: value.cargo, cpf: value.cpf, telefone: value.telefone, pix: value.pix, senha: value.senha, data: dataAtual };
        value = Object.assign({}, lista, newEntry);

        localStorage.setItem("funcionarios", JSON.stringify(value));

        location.reload();
    }

    const form = document.querySelector('form');
    form.addEventListener('submit', handleSubmit);
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>