<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="./css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">

    <title>Document</title>
</head>
<body>
    <!-- Cabeçalho -->
    <header class="px-4 d-flex align-items-center">
        <div class="flex-grow-1">
            <img src="./img/ifood-logo.svg" alt="Logo do iFood" class="logo-ifood ms-5">
        </div>
        
        <div class="d-flex gap-4">
            <img src="./img/bell.svg" alt="Ícone de Notificação" class="pointer">
            <img src="./img/mensagem.svg" alt="Ícone de Mensagem" class="pointer">
            <img src="./img/perfil.svg" alt="Ícone de Perfil" class="pointer">
        </div>
    </header>
    
    <div class="d-flex">
        <!-- Navegação -->
        <div class="w-25 d-flex navegacao flex-column">
            <div class="w-100 d-flex justify-content-center align-items-center" style="height: 200px;">
                <img src="./img/brabo-logo.png" alt="Logo da Brabo" class="rounded-circle h-50">
            </div>

            <nav class="d-flex justify-content-center align-items-center">
                <ul class="nav nav-pills d-flex flex-column gap-3">
                    <li class="nav-item dropdown d-flex">
                        <img src="./img/dashboard.svg" alt="Ícone de Casa" class="mx-3">
                        <a class="link-nav dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" href="#">Dashboard</a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="dashboard-entrada.html">Entradas</a></li>
                            <li><a class="dropdown-item" href="#">Saídas</a></li>
                        </ul>
                    </li>
                    <li class="nav-item d-flex">
                        <img src="./img/produtos.svg" alt="Ícone de Casa" class="mx-3">
                        <a class="link-nav-active dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" href="#">Produtos</a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="produtos-cadastrar.html">Cadastrar</a></li>
                            <li><a class="dropdown-item" href="produtos-lista.html">Lista</a></li>
                        </ul>
                    </li>
                    <li class="nav-item d-flex">
                        <img src="./img/fornecedores.svg" alt="Ícone de Casa" class="mx-3">
                        <a class="link-nav" aria-current="page" href="dashboard-entrada.html">Fornecedores</a>
                    </li>
                    <li class="nav-item d-flex">
                        <img src="./img/funcionarios.svg" alt="Ícone de Casa" class="mx-3">
                        <a class="link-nav" aria-current="page" href="dashboard-entrada.html">Funcionários</a>
                    </li>
                    <li class="nav-item d-flex">
                        <img src="./img/pagamentos.svg" alt="Ícone de Casa" class="mx-3">
                        <a class="link-nav" aria-current="page" href="dashboard-entrada.html">Pagamentos</a>
                    </li>
                    <li class="nav-item d-flex">
                        <img src="./img/vendas.svg" alt="Ícone de Casa" class="mx-3">
                        <a class="link-nav" aria-current="page" href="dashboard-entrada.html">Vendas</a>
                    </li>
                </ul>
            </nav>
        </div>

        <!-- Dashboard -->
        <div class="w-100 container p-3">
            <!-- Form -->
            <h2 class="mt-3 ms-2">Cadastrar Produto: 1</h2>

            <form class="d-flex mt-4 w-100">
                <!-- Primeira Coluna -->
                <div class="d-flex flex-column w-50 p-2">
                    <label for="nome" class="ms-1">Nome:</label>
                    <input id="nome" name="nome" type="text" class="rounded-3 w-100" />

                    <label for="desc" class="ms-1 mt-4">Descrição:</label>
                    <textarea id="desc" name="desc" rows="3" class="rounded-3 w-100"></textarea>

                    <label for="infonutri" class="ms-1 mt-4">Informação Nutricional:</label>
                    <textarea id="infonutri" name="infonutri" rows="5" class="rounded-3 w-100"></textarea>
                </div>

                <!-- Segunda Coluna -->
                <div class="d-flex flex-column w-50 p-2">
                    <label for="img" class="ms-1">Imagem:</label>
                    <input id="img" name="img" type="file" accept="image/*" onchange="mostrarImagem(event)" class="rounded-3 w-75" />
                    <label for="img">
                        <img id="img-form" class="w-75"/>
                    </label>

                    <label for="quantvendas" class="ms-1 mt-4">Quantidade de Vendas:</label>
                    <input id="quantvendas" name="quantvendas" type="number" class="rounded-3 w-75" />

                    <label for="valor" class="ms-1 mt-4">Valor:</label>
                    <input id="valor" name="valor" type="text" onkeydown="mascararValor(event)" class="rounded-3 w-75" />

                    <input id="cadastrar" type="submit" class="rounded-3 mt-4" value="Cadastrar" />
                </div>
            </form>
        </div>
    </div>

    <script type="text/javascript">
    function mostrarImagem(event) {
        const file = event.target.files[0];
        const imgForm = document.getElementById('img-form');
        imgForm.src = URL.createObjectURL(file);

        document.getElementById('img').style.display = 'none';

        imgForm.onload = function() {
            URL.revokeObjectURL(imgForm.src) // limpar a memória
        }
    }

    let valor = '';
    function mascararValor(event) {
        event.preventDefault();

        if(event.key == 'Backspace' && valor != '') {
            valor = valor.slice(0, -1); 
        }
        else if(event.key.match(/[0-9]/g)) {
            valor += event.key; 
        }

        if (valor != '') {
            let pontos = valor.length > 2?Math.floor((valor.length - 3) / 3):0;

            let currency = valor.split("");
            currency = currency.reverse();
            currency = currency.join("");

            currency = currency.padEnd(3, '0');
            currency = currency.substring(0, 2) + ',' + currency.substring(2, currency.length);

            currency = currency.split("");
            currency = currency.reverse();
            currency = currency.join("");

            currency = currency.replace('.','');

            for(var i = 0; i < pontos; i++) {
                var resto = (currency.length - 3 - i) % 3;
                resto = resto == 0 ? 3 : resto;
                console.log(resto);

                currency = currency.substring(0, resto + (3 * i) + i) + '.' + currency.substring(resto + (3 * i) + i, currency.length);
            }

            event.target.value = 'R$ ' + currency;
        }
        else {
            event.target.value = valor;
        }
    }

    function handleSubmit(event) {
        event.preventDefault();

        const data = new FormData(event.target);

        let value = Object.fromEntries(data.entries());
        value = { id: 1, nome: value.nome, desc: value.desc, infonutri: value.infonutri, img: value.img, quantvendas: value.quantvendas, valor: value.valor };

        localStorage.setItem("produtos", JSON.stringify(value));
    }

    const form = document.querySelector('form');
    form.addEventListener('submit', handleSubmit);
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>